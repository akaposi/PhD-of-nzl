
\AgdaHide{

\begin{code}\>\<%
\\
%
\\
\>\AgdaSymbol{\{-\#} \AgdaKeyword{OPTIONS} --type-in-type \AgdaSymbol{\#-\}}\<%
\\
%
\\
\>\AgdaKeyword{import} \AgdaModule{Level}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Relation.Binary.PropositionalEquality} \AgdaSymbol{as} \AgdaModule{PE} \AgdaKeyword{hiding} \AgdaSymbol{(}refl \AgdaSymbol{;} sym \AgdaSymbol{;} trans\AgdaSymbol{;} isEquivalence\AgdaSymbol{;} [\_]\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaKeyword{import} \AgdaModule{CwF-setoid}\<%
\\
%
\\
\>\AgdaKeyword{import} \AgdaModule{CategoryOfSetoid}\<%
\\
\>\AgdaKeyword{import} \AgdaModule{hProp}\<%
\\
%
\\
\>\AgdaKeyword{module} \AgdaModule{CwF-ctd} \AgdaSymbol{(}\AgdaBound{ext} \AgdaSymbol{:} \AgdaFunction{Extensionality} \AgdaPrimitive{Level.zero} \AgdaPrimitive{Level.zero}\AgdaSymbol{)} \AgdaKeyword{where}\<%
\\
%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Unit}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Function}\<%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Product}\<%
\\
%
\\
%
\\
\>\AgdaKeyword{open} \AgdaKeyword{module} \AgdaModule{hp'} \AgdaSymbol{=} \AgdaModule{hProp} \AgdaBound{ext}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{CwF-setoid} \AgdaBound{ext}\<%
\\
%
\\
\>\AgdaKeyword{module} \AgdaModule{cos'} \AgdaSymbol{=} \AgdaModule{CategoryOfSetoid} \AgdaBound{ext}\<%
\\
\>\AgdaKeyword{open} \AgdaModule{cos'}\<%
\\
%
\\
%
\\
\>\AgdaKeyword{open} \AgdaKeyword{import} \AgdaModule{Data.Nat}\<%
\\
%
\\
%
\\
\>\<\end{code}
}


We also implement some common types within the syntactic structure of this type theory. For example, natural numbers and the simply typed universe. I will only present the natural numbers here.

\AgdaHide{
\begin{code}\>\<%
\\
%
\\
\>\AgdaFunction{\_≈nat\_} \AgdaSymbol{:} \AgdaDatatype{ℕ} \AgdaSymbol{→} \AgdaDatatype{ℕ} \AgdaSymbol{→} \AgdaRecord{hProp}\<%
\\
\>\AgdaInductiveConstructor{zero} \AgdaFunction{≈nat} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaFunction{⊤'}\<%
\\
\>\AgdaInductiveConstructor{zero} \AgdaFunction{≈nat} \AgdaInductiveConstructor{suc} \AgdaBound{n} \AgdaSymbol{=} \AgdaFunction{⊥'}\<%
\\
\>\AgdaInductiveConstructor{suc} \AgdaBound{m} \AgdaFunction{≈nat} \AgdaInductiveConstructor{zero} \AgdaSymbol{=} \AgdaFunction{⊥'}\<%
\\
\>\AgdaInductiveConstructor{suc} \AgdaBound{m} \AgdaFunction{≈nat} \AgdaInductiveConstructor{suc} \AgdaBound{n} \AgdaSymbol{=} \AgdaBound{m} \AgdaFunction{≈nat} \AgdaBound{n}\<%
\\
%
\\
%
\\
\>\AgdaFunction{reflNat} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{<} \AgdaBound{x} \AgdaFunction{≈nat} \AgdaBound{x} \AgdaFunction{>} \<[33]%
\>[33]\<%
\\
\>\AgdaFunction{reflNat} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaInductiveConstructor{tt}\<%
\\
\>\AgdaFunction{reflNat} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{reflNat} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}}\<%
\\
%
\\
\>\AgdaFunction{symNat} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{<} \AgdaBound{x} \AgdaFunction{≈nat} \AgdaBound{y} \AgdaFunction{>} \AgdaSymbol{→} \AgdaFunction{<} \AgdaBound{y} \AgdaFunction{≈nat} \AgdaBound{x} \AgdaFunction{>}\<%
\\
\>\AgdaFunction{symNat} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaBound{eq} \AgdaSymbol{=} \AgdaInductiveConstructor{tt}\<%
\\
\>\AgdaFunction{symNat} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaSymbol{\_\}} \AgdaBound{eq} \AgdaSymbol{=} \AgdaBound{eq}\<%
\\
\>\AgdaFunction{symNat} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaBound{eq} \AgdaSymbol{=} \AgdaBound{eq}\<%
\\
\>\AgdaFunction{symNat} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{y}\AgdaSymbol{\}} \AgdaBound{eq} \AgdaSymbol{=} \AgdaFunction{symNat} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaBound{eq}\<%
\\
%
\\
\>\AgdaFunction{transNat} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaBound{z} \AgdaSymbol{:} \AgdaDatatype{ℕ}\AgdaSymbol{\}} \AgdaSymbol{→} \<[25]%
\>[25]\<%
\\
\>[0]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaFunction{<} \AgdaBound{x} \AgdaFunction{≈nat} \AgdaBound{y} \AgdaFunction{>} \AgdaSymbol{→} \<[26]%
\>[26]\<%
\\
\>[0]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaFunction{<} \AgdaBound{y} \AgdaFunction{≈nat} \AgdaBound{z} \AgdaFunction{>} \<[24]%
\>[24]\<%
\\
\>[0]\AgdaIndent{9}{}\<[9]%
\>[9]\AgdaSymbol{→} \AgdaFunction{<} \AgdaBound{x} \AgdaFunction{≈nat} \AgdaBound{z} \AgdaFunction{>}\<%
\\
\>\AgdaFunction{transNat} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaBound{xy} \AgdaBound{yz} \AgdaSymbol{=} \AgdaBound{yz}\<%
\\
\>\AgdaFunction{transNat} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaSymbol{\_\}} \AgdaSymbol{()} \AgdaBound{yz}\<%
\\
\>\AgdaFunction{transNat} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaSymbol{()} \AgdaBound{yz}\<%
\\
\>\AgdaFunction{transNat} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaSymbol{\_\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{zero}\AgdaSymbol{\}} \AgdaBound{xy} \AgdaBound{yz} \AgdaSymbol{=} \AgdaBound{yz}\<%
\\
\>\AgdaFunction{transNat} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{suc} \AgdaBound{z}\AgdaSymbol{\}} \AgdaBound{xy} \AgdaBound{yz} \AgdaSymbol{=} \AgdaFunction{transNat} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaBound{xy} \AgdaBound{yz}\<%
\\
%
\\
%
\\
\>\<\end{code}
}


The semantic of natural numbers is just natural numbers and the equivalence relation is defined recursively with respect to case analysis on natural numbers. Other operations and properties of this type can be proved easily.

\begin{code}\>\<%
\\
%
\\
\>\AgdaFunction{⟦Nat⟧} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Con}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaRecord{Ty} \AgdaBound{Γ}\<%
\\
\>\AgdaFunction{⟦Nat⟧} \AgdaSymbol{=} \AgdaKeyword{record} \<[15]%
\>[15]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{} \AgdaField{fm} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{γ} \AgdaSymbol{→} \AgdaKeyword{record}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{\{} \AgdaField{Carrier} \AgdaSymbol{=} \AgdaDatatype{ℕ}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{;} \AgdaField{\_≈h\_} \<[17]%
\>[17]\AgdaSymbol{=} \AgdaFunction{\_≈nat\_}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{;} \AgdaField{isEquiv} \AgdaSymbol{=} \AgdaKeyword{record} \<[26]%
\>[26]\<%
\\
\>[7]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{\{} \AgdaField{refl} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{reflNat} \AgdaSymbol{\{}\AgdaBound{n}\AgdaSymbol{\}}\<%
\\
\>[7]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{;} \AgdaField{sym} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{symNat} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}}\<%
\\
\>[7]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{;} \AgdaField{trans} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{transNat} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}}\<%
\\
\>[7]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{;} \AgdaField{substT} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{id}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{;} \AgdaField{subst*} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{id}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{;} \AgdaField{refl*} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{x} \AgdaBound{a} \AgdaSymbol{→} \AgdaFunction{reflNat} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{;} \AgdaField{trans*} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{p} \AgdaBound{q} \AgdaBound{a} \AgdaSymbol{→} \AgdaFunction{reflNat} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \<[35]%
\>[35]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\}}\<%
\\
%
\\
\>\<\end{code}

Zero and successor operator can be defined as follows.

\begin{code}\>\<%
\\
%
\\
\>\AgdaFunction{⟦0⟧} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Con}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaRecord{Tm} \AgdaSymbol{\{}\AgdaBound{Γ}\AgdaSymbol{\}} \AgdaFunction{⟦Nat⟧}\<%
\\
\>\AgdaFunction{⟦0⟧} \AgdaSymbol{=} \AgdaKeyword{record}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{\{} \AgdaField{tm} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaNumber{0}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{;} \AgdaField{respt} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{p} \AgdaSymbol{→} \AgdaInductiveConstructor{tt}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{\}}\<%
\\
%
\\
\>\AgdaFunction{⟦s⟧} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Con}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaRecord{Tm} \AgdaSymbol{\{}\AgdaBound{Γ}\AgdaSymbol{\}}\AgdaFunction{⟦Nat⟧} \AgdaSymbol{→} \AgdaRecord{Tm} \AgdaSymbol{\{}\AgdaBound{Γ}\AgdaSymbol{\}} \AgdaFunction{⟦Nat⟧}\<%
\\
\>\AgdaFunction{⟦s⟧} \AgdaSymbol{(}\AgdaInductiveConstructor{tm:} \AgdaBound{t} \AgdaInductiveConstructor{resp:} \AgdaBound{respt}\AgdaSymbol{)} \<[24]%
\>[24]\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{=} \AgdaKeyword{record}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{\{} \AgdaField{tm} \AgdaSymbol{=} \AgdaInductiveConstructor{suc} \AgdaFunction{∘} \AgdaBound{t}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{;} \AgdaField{respt} \AgdaSymbol{=} \AgdaBound{respt}\<%
\\
\>[2]\AgdaIndent{4}{}\<[4]%
\>[4]\AgdaSymbol{\}}\<%
\\
%
\\
\>\<\end{code}

\AgdaHide{
\begin{code}\>\<%
\\
\>\AgdaComment{-- Simply-typed-universe}\<%
\\
%
\\
%
\\
\>\AgdaKeyword{data} \AgdaDatatype{⟦U⟧⁰} \AgdaSymbol{:} \AgdaPrimitiveType{Set} \AgdaKeyword{where}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{nat} \AgdaSymbol{:} \<[9]%
\>[9]\AgdaDatatype{⟦U⟧⁰}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaInductiveConstructor{arr<\_,\_>} \AgdaSymbol{:} \<[14]%
\>[14]\AgdaDatatype{⟦U⟧⁰} \AgdaSymbol{→} \<[22]%
\>[22]\AgdaDatatype{⟦U⟧⁰} \AgdaSymbol{→} \<[30]%
\>[30]\AgdaDatatype{⟦U⟧⁰}\<%
\\
%
\\
\>\AgdaFunction{\_	extasciitilde⟦U⟧\_} \AgdaSymbol{:} \AgdaDatatype{⟦U⟧⁰} \AgdaSymbol{→} \AgdaDatatype{⟦U⟧⁰} \AgdaSymbol{→} \AgdaRecord{hProp}\<%
\\
\>\AgdaInductiveConstructor{nat} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaInductiveConstructor{nat} \AgdaSymbol{=} \AgdaFunction{⊤'}\<%
\\
\>\AgdaInductiveConstructor{nat} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>} \AgdaSymbol{=} \AgdaFunction{⊥'}\<%
\\
\>\AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaInductiveConstructor{nat} \AgdaSymbol{=} \AgdaFunction{⊥'}\<%
\\
\>\AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaInductiveConstructor{arr<} \AgdaBound{a'} \AgdaInductiveConstructor{,} \AgdaBound{b'} \AgdaInductiveConstructor{>} \AgdaSymbol{=} \AgdaBound{a} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaBound{a'} \AgdaFunction{∧} \AgdaBound{b} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaBound{b'}\<%
\\
%
\\
\>\AgdaFunction{reflU} \AgdaSymbol{:} \<[9]%
\>[9]\AgdaSymbol{\{}\AgdaBound{x} \AgdaSymbol{:} \AgdaDatatype{⟦U⟧⁰}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{<} \AgdaBound{x} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaBound{x} \AgdaFunction{>}\<%
\\
\>\AgdaFunction{reflU} \AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaInductiveConstructor{tt}\<%
\\
\>\AgdaFunction{reflU} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaSymbol{=} \AgdaFunction{reflU} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaInductiveConstructor{,} \AgdaFunction{reflU} \AgdaSymbol{\{}\AgdaBound{b}\AgdaSymbol{\}}\<%
\\
%
\\
\>\AgdaFunction{symU} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaSymbol{:} \AgdaDatatype{⟦U⟧⁰}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{<} \AgdaBound{x} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaBound{y} \AgdaFunction{>} \AgdaSymbol{→} \AgdaFunction{<} \AgdaBound{y} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaBound{x} \AgdaFunction{>}\<%
\\
\>\AgdaFunction{symU} \AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSymbol{\}} \AgdaBound{eq} \AgdaSymbol{=} \AgdaInductiveConstructor{tt}\<%
\\
\>\AgdaFunction{symU} \AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaBound{eq} \AgdaSymbol{=} \AgdaBound{eq}\<%
\\
\>\AgdaFunction{symU} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSymbol{\}} \AgdaBound{eq} \AgdaSymbol{=} \AgdaBound{eq}\<%
\\
\>\AgdaFunction{symU} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a'} \AgdaInductiveConstructor{,} \AgdaBound{b'} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{p} \AgdaInductiveConstructor{,} \AgdaBound{q}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaSymbol{(}\AgdaFunction{symU} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{a'}\AgdaSymbol{\}} \AgdaBound{p}\AgdaSymbol{)} \AgdaInductiveConstructor{,} \AgdaSymbol{(}\AgdaFunction{symU} \AgdaSymbol{\{}\AgdaBound{b}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{b'}\AgdaSymbol{\}} \AgdaBound{q}\AgdaSymbol{)}\<%
\\
%
\\
\>\AgdaFunction{transU} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{x} \AgdaBound{y} \AgdaBound{z} \AgdaSymbol{:} \AgdaDatatype{⟦U⟧⁰}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{<} \AgdaBound{x} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaBound{y} \AgdaFunction{>} \AgdaSymbol{→} \AgdaFunction{<} \AgdaBound{y} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaBound{z} \AgdaFunction{>} \AgdaSymbol{→} \AgdaFunction{<} \AgdaBound{x} \AgdaFunction{	extasciitilde⟦U⟧} \AgdaBound{z} \AgdaFunction{>}\<%
\\
\>\AgdaFunction{transU} \AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSymbol{\}} \AgdaBound{eq1} \AgdaBound{eq2} \AgdaSymbol{=} \AgdaBound{eq2}\<%
\\
\>\AgdaFunction{transU} \AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaSymbol{()} \AgdaBound{eq2}\<%
\\
\>\AgdaFunction{transU} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSymbol{\}} \AgdaSymbol{()} \AgdaBound{eq2}\<%
\\
\>\AgdaFunction{transU} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a'} \AgdaInductiveConstructor{,} \AgdaBound{b'} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{nat}\AgdaSymbol{\}} \AgdaBound{eq1} \AgdaBound{eq2} \AgdaSymbol{=} \AgdaBound{eq2}\<%
\\
\>\AgdaFunction{transU} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a'} \AgdaInductiveConstructor{,} \AgdaBound{b'} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaInductiveConstructor{arr<} \AgdaBound{a0} \AgdaInductiveConstructor{,} \AgdaBound{b0} \AgdaInductiveConstructor{>}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{p1} \AgdaInductiveConstructor{,} \AgdaBound{q1}\AgdaSymbol{)} \AgdaSymbol{(}\AgdaBound{p2} \AgdaInductiveConstructor{,} \AgdaBound{q2}\AgdaSymbol{)} \AgdaSymbol{=}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{(}\AgdaFunction{transU} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{a'}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{a0}\AgdaSymbol{\}} \AgdaBound{p1} \AgdaBound{p2}\AgdaSymbol{)} \AgdaInductiveConstructor{,} \AgdaFunction{transU} \AgdaSymbol{\{}\AgdaBound{b}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{b'}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{b0}\AgdaSymbol{\}} \AgdaBound{q1} \AgdaBound{q2}\<%
\\
%
\\
\>\AgdaFunction{⟦U⟧} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Con}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaRecord{Ty} \AgdaBound{Γ}\<%
\\
\>\AgdaFunction{⟦U⟧} \AgdaSymbol{=} \AgdaKeyword{record} \<[13]%
\>[13]\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\{} \AgdaField{fm} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{γ} \AgdaSymbol{→} \AgdaKeyword{record}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{\{} \AgdaField{Carrier} \AgdaSymbol{=} \AgdaDatatype{⟦U⟧⁰}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{;} \AgdaField{\_≈h\_} \AgdaSymbol{=} \AgdaFunction{\_	extasciitilde⟦U⟧\_}\<%
\\
\>[2]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{;} \AgdaField{isEquiv} \AgdaSymbol{=} \AgdaKeyword{record}\<%
\\
\>[7]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{\{} \AgdaField{refl} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{reflU} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}}\<%
\\
\>[7]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{;} \AgdaField{sym} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{symU} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}}\<%
\\
\>[7]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{;} \AgdaField{trans} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaFunction{transU} \AgdaSymbol{\{}\AgdaBound{x}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{y}\AgdaSymbol{\}} \AgdaSymbol{\{}\AgdaBound{z}\AgdaSymbol{\}}\<%
\\
\>[7]\AgdaIndent{11}{}\<[11]%
\>[11]\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{7}{}\<[7]%
\>[7]\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{;} \AgdaField{substT} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{id}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{;} \AgdaField{subst*} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{\_} \AgdaSymbol{→} \AgdaFunction{id}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{;} \AgdaField{refl*} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{x} \AgdaBound{a} \AgdaSymbol{→} \AgdaFunction{reflU} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{;} \AgdaField{trans*} \AgdaSymbol{=} \AgdaSymbol{λ} \AgdaBound{p} \AgdaBound{q} \AgdaBound{a} \AgdaSymbol{→} \AgdaFunction{reflU} \AgdaSymbol{\{}\AgdaBound{a}\AgdaSymbol{\}}\<%
\\
\>[0]\AgdaIndent{2}{}\<[2]%
\>[2]\AgdaSymbol{\}}\<%
\\
%
\\
\>\AgdaFunction{elfm} \AgdaSymbol{:} \AgdaSymbol{\{}\AgdaBound{Γ} \AgdaSymbol{:} \AgdaFunction{Con}\AgdaSymbol{\}} \AgdaSymbol{→} \AgdaRecord{Σ} \AgdaFunction{∣} \AgdaBound{Γ} \AgdaFunction{∣} \AgdaSymbol{(λ} \AgdaBound{x} \AgdaSymbol{→} \AgdaDatatype{⟦U⟧⁰}\AgdaSymbol{)} \AgdaSymbol{→} \AgdaRecord{hSetoid}\<%
\\
\>\AgdaFunction{elfm} \AgdaSymbol{\{}\AgdaBound{Γ}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{γ} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{nat}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{[} \AgdaFunction{⟦Nat⟧} \AgdaSymbol{\{}\AgdaBound{Γ}\AgdaSymbol{\}} \AgdaFunction{]fm} \AgdaBound{γ}\<%
\\
\>\AgdaFunction{elfm} \AgdaSymbol{\{}\AgdaBound{Γ}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{γ} \AgdaInductiveConstructor{,} \AgdaInductiveConstructor{arr<} \AgdaBound{a} \AgdaInductiveConstructor{,} \AgdaBound{b} \AgdaInductiveConstructor{>}\AgdaSymbol{)} \AgdaSymbol{=} \AgdaFunction{[} \AgdaBound{Γ} \AgdaFunction{,} \AgdaBound{γ} \AgdaFunction{]} \AgdaFunction{elfm} \AgdaSymbol{\{}\AgdaBound{Γ}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{γ} \AgdaInductiveConstructor{,} \AgdaBound{a}\AgdaSymbol{)} \AgdaFunction{⇒fm} \AgdaFunction{elfm} \AgdaSymbol{\{}\AgdaBound{Γ}\AgdaSymbol{\}} \AgdaSymbol{(}\AgdaBound{γ} \AgdaInductiveConstructor{,} \AgdaBound{b}\AgdaSymbol{)}\<%
\\
%
\\
%
\\
%
\\
\>\AgdaComment{\{- To do : To find the way to extract the substT from ->

  elsubstT : \{x y : Σ ∣ Γ ∣ (λ x' → ⟦U⟧⁰)\} →
      Σ < [ Γ ] proj₁ x ≈h proj₁ y > (λ x' → < proj₂ x 	extasciitilde⟦U⟧ proj₂ y >) →
      ∣ elfm x ∣ → ∣ elfm y ∣
  elsubstT \{\_ , nat\} \{\_ , nat\} \_ x' = x'
  elsubstT \{\_ , nat\} \{\_ , arr< a , b >\} (p , ()) x'
  elsubstT \{\_ , arr< a , b >\} \{\_ , nat\} (p , ()) x'
  elsubstT \{γ , arr< a , b >\} \{γ' , arr< a' , b' >\} (p , qa , qb) (s1 , s2) = 
   \{!!\}

  ⟦El⟧ : Ty (Γ \& ⟦U⟧)
  ⟦El⟧ = record 
       \{ fm = elfm
       ; substT = elsubstT
       ; subst* = \{!!\}
       ; refl* = \{!!\}
       ; trans* = \{!!\} 
       \}

-\}}\<%
\\
%
\\
%
\\
%
\\
%
\\
\>\<\end{code}
}